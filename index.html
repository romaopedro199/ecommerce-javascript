<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
    <link rel="stylesheet" href="assets/css/glider.min.css">
    <title>Ecommerce</title>
  </head>
  <body onload="checkCart()">
    <nav class="nav-menu d-flex align-center justify-between">
      <div class="d-flex align-center">
        <span class="nav-logo">Pick Bazar</span>

        <div class="position-relative">
          <button class="nav-filter d-flex align-center justify-between">
            <div>
              <i class="fas fa-shopping-bag"></i>
              Bags
            </div>
            <i class="fas fa-sort-down"></i>
          </button>
          <div class="nav-filter__list">
            <button class="nav-filter__option d-flex align-center">
              <i class="fas fa-shopping-bag"></i>
              Clothing
            </button>
          </div>
        </div>

      </div>
      <div class="d-flex align-center">
        <a href="#" class="nav-link">Shop</a>
        <a href="#" class="nav-link">Offers</a>
      </div>
    </nav>

    <div class="cover d-flex align-center">
      <h1>Exclusive Branded bags</h1>
      <p>Get your exclusive & branded bags delivered to you in no time</p>
      <form class="d-flex align-center">
        <input type="text" placeholder="Search">
        <button class="d-flex align-center">
          <i class="fas fa-search"></i>
          Search
        </button>
      </form>
    </div>

    <div class="carousel">
      <div class="glider-contain">
        <div class="glider">
            <div><img alt="Test" src="assets/img/offer-4.png"></div>
            <div><img alt="Test" src="assets/img/offer-3.png"></div>
            <div><img alt="Test" src="assets/img/offer-4.png"></div>
            <div><img alt="Test" src="assets/img/offer-3.png"></div>
            <div><img alt="Test" src="assets/img/offer-4.png"></div>
            <div><img alt="Test" src="assets/img/offer-3.png"></div>
            <div><img alt="Test" src="assets/img/offer-4.png"></div>
            <div><img alt="Test" src="assets/img/offer-3.png"></div>
        </div>
        <button class="glider-prev"><i class="fas fa-chevron-left"></i></button>
        <button class="glider-next"><i class="fas fa-chevron-right"></i></button>
      </div>
    </div>

    <div class="content d-flex">
      <div class="sidebar">
        <div class="sidebar-option d-flex align-center">
          <i class="fas fa-air-freshener"></i>
          Text
        </div>
        <div class="sidebar-option d-flex align-center">
          <i class="fas fa-air-freshener"></i>
          Text
        </div>
        <div class="sidebar-option d-flex align-center">
          <i class="fas fa-air-freshener"></i>
          Text
        </div>
      </div>

      <div class="items d-flex">
        <div class="col">
          <div class="item">
            <img src="assets/img/bag.jpg" alt="">
            <div class="item-text">
              <h3>Bag</h3>
              <p>1 pc(s)</p>
            </div>
            <div class="item-footer d-flex align-center justify-between">
              <strong>R$200</strong>
              <button id="product-1" onclick="addToCard(event)">
                <i class="fas fa-shopping-cart"></i>
                Cart
              </button>
              <div id="change-product-1" class="change-quantity d-flex align-center hidden">
                <span id="remove-product-1" onclick="removeToCard(event)">-</span>
                <strong>1</strong>
                <span id="add-product-1" onclick="addToCard(event, true)">+</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="item">
            <img src="assets/img/bag.jpg" alt="">
            <div class="item-text">
              <h3>Bag</h3>
              <p>1 pc(s)</p>
            </div>
            <div class="item-footer d-flex align-center justify-between">
              <strong>R$200</strong>
              <button id="product-2" onclick="addToCard(event)">
                <i class="fas fa-shopping-cart"></i>
                Cart
              </button>
              <div id="change-product-2" class="change-quantity d-flex align-center hidden">
                <span id="remove-product-2" onclick="removeToCard(event)">-</span>
                <strong>1</strong>
                <span id="add-product-2" onclick="addToCard(event, true)">+</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="item">
            <img src="assets/img/bag.jpg" alt="">
            <div class="item-text">
              <h3>Bag</h3>
              <p>1 pc(s)</p>
            </div>
            <div class="item-footer d-flex align-center justify-between">
              <strong>R$200</strong>
              <button id="product-3" onclick="addToCard(event)">
                <i class="fas fa-shopping-cart"></i>
                Cart
              </button>
              <div id="change-product-3" class="change-quantity d-flex align-center hidden">
                <span id="remove-product-3" onclick="removeToCard(event)">-</span>
                <strong>1</strong>
                <span id="add-product-3" onclick="addToCard(event, true)">+</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="assets/javascript/glider.min.js"></script>
    <script>
      const navFilter = document.querySelector('.nav-filter');
      const navFilterList = document.querySelector('.nav-filter__list');

      navFilter.addEventListener('click', () => {
        if (navFilterList.classList.contains('show')) {
          navFilterList.classList.remove('show');
        } else {
          navFilterList.classList.add('show');
        }
      });
    </script>

    <script>
      function checkCart () {
        let cart = [];

        if (window.sessionStorage.getItem('shoppingCart')) {
          cart = JSON.parse(window.sessionStorage.getItem('shoppingCart'));
        }

        cart.forEach(item => {
          if (item.quantity) {
            document.getElementById(item.id).classList.add('hidden');
            document.getElementById(`change-${item.id}`).classList.remove('hidden');
            document.querySelector(`#change-${item.id} strong`).innerHTML = item.quantity;
          }
        })
      }

      function formatProductId (productId) {
        if (productId.includes('add-')) {
          return productId.replace('add-', '');
        }
        return productId;
      }

      function addToCard (event, spanAdd = false) {
        const cartButton = event.target;

        const productId = formatProductId(event.target.id);
        
        let cart = [];

        if (window.sessionStorage.getItem('shoppingCart')) {
          cart = JSON.parse(window.sessionStorage.getItem('shoppingCart'));
        }

        let indexToChange = null;

        cart.find((item, index) => {
          if (item.id === productId) {
            indexToChange = index;
          }
        });

        if (indexToChange !== null) {
          cart[indexToChange].quantity++;
          document.querySelector(`#change-${productId} strong`).innerHTML = cart[indexToChange].quantity;
        } else {
          cart.push({
            id: productId,
            quantity: 1
          });

          !spanAdd && cartButton.classList.add('hidden');
          !spanAdd && document.getElementById(`change-${productId}`).classList.remove('hidden');
        }
        
        window.sessionStorage.setItem('shoppingCart', JSON.stringify(cart));
      }

      function removeToCard (event) {
        const productId = event.target.id.replace('remove-', '');
        const cartButton = document.getElementById(productId);

        let cart = JSON.parse(window.sessionStorage.getItem('shoppingCart'));
        let indexToChange = null;

        cart.find((item, index) => {
          if (item.id === productId) {
            indexToChange = index;
          }
        });

        if (indexToChange !== null) {
          cart[indexToChange].quantity--;
          
          if (!cart[indexToChange].quantity) {
            document.getElementById(`change-${productId}`).classList.add('hidden');
            cartButton.classList.remove('hidden');
            cart.splice(indexToChange, 1);
          } else {
            document.querySelector(`#change-${productId} strong`).innerHTML = cart[indexToChange].quantity;
          }
        }
        
        window.sessionStorage.setItem('shoppingCart', JSON.stringify(cart));
      }
    </script>

    <!-- Configuração do glider slider -->
    <script>
      window.addEventListener('load',function(){
        document.querySelector('.glider').addEventListener('glider-slide-visible', function(event){
            var glider = Glider(this);
            console.log('Slide Visible %s', event.detail.slide)
        });
        document.querySelector('.glider').addEventListener('glider-slide-hidden', function(event){
            console.log('Slide Hidden %s', event.detail.slide)
        });
        document.querySelector('.glider').addEventListener('glider-refresh', function(event){
            console.log('Refresh')
        });
        document.querySelector('.glider').addEventListener('glider-loaded', function(event){
            console.log('Loaded')
        });

        window._ = new Glider(document.querySelector('.glider'), {
            slidesToShow: 3, //'auto',
            slidesToScroll: 1,
            itemWidth: 300,
            draggable: true,
            scrollLock: false,
            rewind: true,
            arrows: {
                prev: '.glider-prev',
                next: '.glider-next'
            },
        });
      });
    </script>
  </body>
</html>